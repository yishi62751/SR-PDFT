# SR-PDFT
This code implements the spin-density-functional regularization (SR) approach within the framework of Partition Density Functional Theory (PDFT).
The SR approach was developed to mitigate artificial spin symmetry breaking in broken-symmetry DFT calculations, particularly for open-shell strongly correlated systems (e.g., singlet diradicals) that lack genuine spin polarization.

The implementation of the partition potential involves:
(1) Adding a Vp property to the pyscf.scf.hf object.
(2) Modifying pyscf.scf.hf.get_hcore() to include Vp in the core Hamiltonian.

The evaluation of SR-corrected exchange-correlation energy requires: 
(1) The unregularized spin-densities of fragments that are obtained from spin-unrestricted KS-DFT calculations with certain DFAs.
(2) The regularized fragment spin-densities generated by the SR procedure. 

To compute these, two distinct PDFT calculations must be performed:
(1) The first replicates standard KS-DFT results (without regularization).
(2) The second constrains spin populations on the fragments (with SR regularization).

Before calling the functions in fragments.py, ensure the following:
(1) Fragment Definition: The fragments must be explicitly defined in your script.
(2) Ensemble Treatment: Fragments must be treated as ensembles, with their components and weights properly specified.
(3) The partition potential (Vp) must be incorporated into the PySCF SCF solver.

